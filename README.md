# Excel数据处理工具

这个工具用于查找Excel表格之间的数据关联，并将结果输出到新文件。

## 功能说明

该工具可以实现以下功能：
- 查找a表中这样的行：行中x列与b表的y列有数据重合
- 支持处理合并单元格：如果a表中x列的单元格是多行合并的，工具会查找出所有这些行
- 将查找到的行数据保存到新的Excel文件中
- 保留原a表中的合并单元格格式，在结果文件中重建相同的合并单元格结构
- 支持自定义使用哪个工作表(sheet)
- 自动复制表头到结果文件
- 保存函数的计算结果而不是公式本身：如果单元格包含公式（如=SUM()），只会保存计算后的值
- 提供图形用户界面，方便操作和参数设置

## 安装依赖

使用前请确保已安装以下Python库：
```
pip install openpyxl
```

如需使用图形界面，还需安装tkinter（通常Python自带）：
```
pip install tk
```

## 使用方法

### 方法1：使用图形界面（推荐）

运行以下命令启动图形界面：
```
python excel_ui.py
```

在图形界面中：
1. 在"A表"选项卡中设置源数据表的文件路径、工作表名称和比较列
2. 在"B表"选项卡中设置对比数据表的文件路径、工作表名称和比较列
3. 在"输出设置"选项卡中设置输出文件路径和工作表名称
4. 点击"开始处理数据"按钮开始处理

### 方法2：直接修改代码

如果不想使用图形界面，也可以直接修改代码中的参数：

1. 打开 `excel_processor.py` 文件，在 `main()` 函数中设置以下参数：

```python
# 文件路径直接写在代码中
file_a_path = "麓城店日报表2025.5.2.xlsx"  # 修改为实际的A表文件路径
file_b_path = "患者库.xlsx"  # 修改为实际的B表文件路径
output_path = "匹配结果.xlsx"  # 修改为期望的输出文件路径

# 指定要使用的工作表名称
sheet_a_name = "5.1"  # A表中的工作表
sheet_b_name = "Sheet2"  # B表中的工作表
output_sheet_name = "5月日报"  # 输出工作表名称

# 指定比较的列
col_x = "C"  # A表中的列
col_y = "A"  # B表中的列
```

2. 然后运行程序：

```
python excel_processor.py
```

## 注意事项

1. 程序会创建一个全新的文件保存结果，文件名会自动添加时间戳
2. 程序会自动将A表中的第一行作为表头复制到结果文件中
3. 列可以通过字母(A,B,C...)或数字(1,2,3...)指定
4. 比较时会将单元格值转换为字符串进行匹配
5. 程序会自动识别a表中的合并单元格，并在结果文件中保持相同的合并状态
6. 如果指定的工作表不存在，程序会使用活动工作表
7. 如果保存文件时遇到权限问题，程序会尝试保存到桌面
8. 对于A表中包含公式的单元格（如=SUM()），程序只会保存计算后的结果值，而不会保存公式本身
9. 当A表中x列的单元格为空时，该行不会被匹配 