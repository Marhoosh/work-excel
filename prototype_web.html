<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Excel报表与患者库匹配工具 - 原型</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background: #f5f6fa; margin: 0; padding: 0; }
        .container { max-width: 1200px; margin: 30px auto; background: #fff; border-radius: 10px; box-shadow: 0 2px 8px #ddd; padding: 30px; }
        h1 { text-align: center; margin-bottom: 30px; }
        .section { margin-bottom: 40px; }
        .section-title { font-size: 1.2em; margin-bottom: 15px; color: #333; }
        .upload-area { display: flex; gap: 40px; }
        .upload-card { flex: 1; background: #f0f2f5; border-radius: 8px; padding: 20px; text-align: center; border: 1px dashed #bbb; }
        .upload-card input { display: none; }
        .upload-label { display: inline-block; padding: 20px 30px; background: #fff; border-radius: 6px; cursor: pointer; border: 1px solid #ccc; }
        .upload-label i { font-size: 2em; color: #4a90e2; }
        .file-list { margin-top: 15px; text-align: left; }
        .file-item { margin-bottom: 5px; font-size: 0.95em; }
        .settings-area { display: flex; gap: 40px; }
        .settings-card { flex: 1; background: #f8f9fb; border-radius: 8px; padding: 20px; border: 1px solid #eee; }
        .settings-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .settings-table th, .settings-table td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        .settings-table th { background: #f0f2f5; }
        .input-short { width: 80px; }
        .btn { display: inline-block; padding: 8px 18px; border-radius: 5px; border: none; background: #4a90e2; color: #fff; cursor: pointer; font-size: 1em; margin: 0 5px; }
        .btn:disabled { background: #bbb; cursor: not-allowed; }
        .btn-secondary { background: #aaa; }
        .result-area { background: #f8f9fb; border-radius: 8px; padding: 20px; border: 1px solid #eee; }
        .result-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .result-table th, .result-table td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        .result-table th { background: #f0f2f5; }
        .feedback { margin-top: 15px; color: #e67e22; }
        .tab { display: inline-block; padding: 8px 18px; border-radius: 5px 5px 0 0; background: #eee; margin-right: 5px; cursor: pointer; }
        .tab.active { background: #4a90e2; color: #fff; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
<div class="container">
    <h1><i class="fa-solid fa-file-excel"></i> Excel报表与患者库匹配工具</h1>

    <!-- 文件上传区 -->
    <div class="section">
        <div class="section-title"><i class="fa-solid fa-upload"></i> 1. 上传文件</div>
        <div class="upload-area">
            <div class="upload-card">
                <label class="upload-label" for="report-files">
                    <i class="fa-solid fa-file-arrow-up"></i><br>
                    上传报表文件（可多选）
                </label>
                <input type="file" id="report-files" multiple>
                <div class="file-list" id="report-file-list">
                    <!-- 动态显示已上传报表文件 -->
                    <div class="file-item"><i class="fa-solid fa-file-excel"></i> report1.xlsx</div>
                    <div class="file-item"><i class="fa-solid fa-file-excel"></i> report2.xlsx</div>
                </div>
            </div>
            <div class="upload-card">
                <label class="upload-label" for="patient-file">
                    <i class="fa-solid fa-user-injured"></i><br>
                    上传患者库文件（仅1个）
                </label>
                <input type="file" id="patient-file">
                <div class="file-list" id="patient-file-list">
                    <!-- 动态显示已上传患者库文件 -->
                    <div class="file-item"><i class="fa-solid fa-file-excel"></i> patient_db.xlsx</div>
                </div>
            </div>
        </div>
    </div>

    <!-- 设置区 -->
    <div class="section">
        <div class="section-title"><i class="fa-solid fa-sliders"></i> 2. 设置工作表名与列号</div>
        <div>
            <span class="tab active" onclick="showTab('unified')">统一设置</span>
            <span class="tab" onclick="showTab('individual')">单独设置</span>
        </div>
        <div class="settings-area">
            <!-- 统一设置 -->
            <div class="settings-card tab-content active" id="tab-unified">
                <div>
                    <label>报表工作表名：</label>
                    <input class="input-short" type="text" id="unified-sheet" value="Sheet1" oninput="updateUnifiedPreview()">
                    <label>报表列号：</label>
                    <input class="input-short" type="text" id="unified-col" value="A" placeholder="如A、B、C" oninput="updateUnifiedPreview()">
                </div>
                <div style="margin-top: 15px;">
                    <label>患者库工作表名：</label>
                    <input class="input-short" type="text" value="患者信息">
                    <label>患者库列号：</label>
                    <input class="input-short" type="text" value="A" placeholder="如A、B、C">
                </div>
                <!-- 新增：报表文件和患者库文件设置预览表格 -->
                <div style="margin-top: 20px;">
                    <table class="settings-table">
                        <thead>
                            <tr>
                                <th>类型</th>
                                <th>文件名</th>
                                <th>工作表名</th>
                                <th>列号</th>
                            </tr>
                        </thead>
                        <tbody id="unified-preview-tbody">
                            <tr>
                                <td>报表</td>
                                <td>report1.xlsx</td>
                                <td>Sheet1</td>
                                <td>A</td>
                            </tr>
                            <tr>
                                <td>报表</td>
                                <td>report2.xlsx</td>
                                <td>Sheet1</td>
                                <td>A</td>
                            </tr>
                            <tr>
                                <td>患者库</td>
                                <td>patient_db.xlsx</td>
                                <td>患者信息</td>
                                <td>A</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- 单独设置 -->
            <div class="settings-card tab-content" id="tab-individual">
                <table class="settings-table">
                    <thead>
                        <tr>
                            <th>类型</th>
                            <th>文件名</th>
                            <th>工作表名</th>
                            <th>列号</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>报表</td>
                            <td>report1.xlsx</td>
                            <td><input class="input-short" type="text" value="Sheet1"></td>
                            <td><input class="input-short" type="text" value="A" placeholder="如A、B、C"></td>
                        </tr>
                        <tr>
                            <td>报表</td>
                            <td>report2.xlsx</td>
                            <td><input class="input-short" type="text" value="Sheet1"></td>
                            <td><input class="input-short" type="text" value="A" placeholder="如A、B、C"></td>
                        </tr>
                        <tr>
                            <td>患者库</td>
                            <td>patient_db.xlsx</td>
                            <td><input class="input-short" type="text" value="患者信息"></td>
                            <td><input class="input-short" type="text" value="A" placeholder="如A、B、C"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 操作区 -->
    <div class="section">
        <div class="section-title"><i class="fa-solid fa-gears"></i> 3. 匹配与导出</div>
        <button class="btn"><i class="fa-solid fa-magnifying-glass"></i> 执行匹配</button>
        <button class="btn btn-secondary" disabled><i class="fa-solid fa-download"></i> 下载结果Excel</button>
        <span class="feedback"><i class="fa-solid fa-circle-info"></i> 请先执行匹配</span>
    </div>

    <!-- 匹配结果区 -->
    <div class="section">
        <div class="section-title"><i class="fa-solid fa-table"></i> 4. 匹配结果预览</div>
        <div class="result-area">
            <table class="result-table">
                <thead>
                    <tr>
                        <th>报表文件</th>
                        <th>患者姓名</th>
                        <th>匹配状态</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>report1.xlsx</td>
                        <td>张三</td>
                        <td><i class='fa-solid fa-check' style='color:green'></i> 匹配</td>
                    </tr>
                    <tr>
                        <td>report2.xlsx</td>
                        <td>李四</td>
                        <td><i class='fa-solid fa-xmark' style='color:red'></i> 未匹配</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
<script>
    // Tab切换逻辑
    function showTab(tab) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        if(tab === 'unified') {
            document.querySelector('.tab').classList.add('active');
            document.getElementById('tab-unified').classList.add('active');
        } else {
            document.querySelectorAll('.tab')[1].classList.add('active');
            document.getElementById('tab-individual').classList.add('active');
        }
    }
    // 统一设置预览表格同步
    function updateUnifiedPreview() {
        const sheet = document.getElementById('unified-sheet').value;
        const col = document.getElementById('unified-col').value;
        const files = ['report1.xlsx', 'report2.xlsx'];
        let html = '';
        files.forEach(f => {
            html += `<tr><td>${f}</td><td>${sheet}</td><td>${col}</td></tr>`;
        });
        document.getElementById('unified-preview-tbody').innerHTML = html;
    }
</script>
</body>
</html>
